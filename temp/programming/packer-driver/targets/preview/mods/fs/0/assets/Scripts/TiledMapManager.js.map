{"version":3,"sources":["file:///D:/Craft-Monsters/Craft-Monsters/assets/Scripts/TiledMapManager.ts"],"names":["_decorator","Component","Node","log","instantiate","find","Vec3","resources","Prefab","ccclass","property","TiledMapManager","start","update","dt","_isAscend","basedMapPos","basedMap","getPosition","y","setPosition","_timer","_loadEarthMap","x","_cur","z","_loadEarthTiledMap","pos","load","err","prefab","earthMap","setParent"],"mappings":";;;;;;;;;;;;;;;;;;;;AACSA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;AAAgBC,MAAAA,G,OAAAA,G;AAAiBC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,I,OAAAA,I;AAAYC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,M,OAAAA,M;;;;;;;AACnGC,MAAAA,O,GAAsBT,U,CAAtBS,O;AAASC,MAAAA,Q,GAAaV,U,CAAbU,Q;;iCAGJC,e,WADZF,OAAO,CAAC,iBAAD,C,UAEHC,QAAQ,CAACR,IAAD,C;;;;;;;;;;;;;;sEAGoB,I;;mEACJ,C;;iEACF,C;;;;;;;AAAE;eAEzBU,K,GAAA,iBAAS,CACL;AACH,S;;eAGDC,M,GAAA,gBAAOC,EAAP,EAAmB;AACf,cAAI,KAAKC,SAAT,EAAoB;AAChB,gBAAIC,WAAiB,GAAG,KAAKC,QAAL,CAAcC,WAAd,EAAxB;AACAF,YAAAA,WAAW,CAACG,CAAZ,IAAiB,KAAKL,EAAtB;AACA,iBAAKG,QAAL,CAAcG,WAAd,CAA0BJ,WAA1B;AAEA,iBAAKK,MAAL,IAAeP,EAAf;;AACA,gBAAI,KAAKO,MAAL,GAAc,GAAlB,EAAuB;AACnB,mBAAKC,aAAL,CAAmB,IAAIhB,IAAJ,CAASU,WAAW,CAACO,CAArB,EAAwBP,WAAW,CAACG,CAAZ,GAAgB,KAAK,KAAKK,IAAlD,EAAwDR,WAAW,CAACS,CAApE,CAAnB;;AACA,mBAAKD,IAAL;AAEA,mBAAKH,MAAL,GAAc,CAAd;AACH;AAEJ;AACJ,S;;eAGOK,kB,GAAR,4BAA2BC,GAA3B,EAAsC;AAClCpB,UAAAA,SAAS,CAACqB,IAAV,CAAe,eAAf,EAAgCpB,MAAhC,EAAwC,UAACqB,GAAD,EAAWC,MAAX,EAA8B;AAClE,gBAAID,GAAJ,EAAS;AACL1B,cAAAA,GAAG,CAAC,KAAD,EAAQ0B,GAAR,CAAH;AACA;AACH;;AAED,gBAAIE,QAAQ,GAAG3B,WAAW,CAAC0B,MAAD,CAA1B;AACAC,YAAAA,QAAQ,CAACC,SAAT,CAAmB3B,IAAI,CAAC,iBAAD,CAAvB;AACA0B,YAAAA,QAAQ,CAACX,WAAT,CAAqBO,GAArB;AACH,WATD;AAUH,S;;;QA1CgC1B,S;;;;;iBAEhB,I","sourcesContent":["\r\nimport { _decorator, Component, Node, TiledMap, log, TiledLayer, instantiate, find, Vec2, Vec3, resources, Prefab, RigidBody2D } from 'cc';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('TiledMapManager')\r\nexport class TiledMapManager extends Component {\r\n    @property(Node)\r\n    basedMap: Node = null!\r\n\r\n    private _isAscend: boolean = true\r\n    private _timer: number = 0\r\n    private _cur: number = 1 // TODO: change var name later\r\n\r\n    start () {\r\n        // 一上来就要生成10 个 Earth先！\r\n    }\r\n\r\n\r\n    update(dt: number) {\r\n        if (this._isAscend) {\r\n            let basedMapPos: Vec3 = this.basedMap.getPosition()\r\n            basedMapPos.y += 50 * dt\r\n            this.basedMap.setPosition(basedMapPos)\r\n\r\n            this._timer += dt\r\n            if (this._timer > 0.5) {\r\n                this._loadEarthMap(new Vec3(basedMapPos.x, basedMapPos.y - 50 * this._cur, basedMapPos.z))\r\n                this._cur ++\r\n                \r\n                this._timer = 0\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n\r\n    private _loadEarthTiledMap(pos: Vec3) {\r\n        resources.load('prefabs/Earth', Prefab, (err: any, prefab: Prefab) => {\r\n            if (err) {\r\n                log('err', err)\r\n                return\r\n            }\r\n\r\n            let earthMap = instantiate(prefab) as Node\r\n            earthMap.setParent(find('Canvas/MapNodes'))\r\n            earthMap.setPosition(pos)\r\n        })\r\n    }\r\n}"]}